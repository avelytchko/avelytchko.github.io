<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Alexander's Blog - Ruby</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">Alexander's Blog </a></h1>
                <nav><ul>
                    <li><a href="/category/linux.html">Linux</a></li>
                    <li><a href="/category/python.html">Python</a></li>
                    <li class="active"><a href="/category/ruby.html">Ruby</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="/ruhoh-install.html">Installing Ruhoh</a></h1>
<footer class="post-info">
        <abbr class="published" title="2013-10-03T15:00:00+03:00">
                Published: Thu 03 October 2013
        </abbr>
		<br />
        <abbr class="modified" title="2015-01-28T16:00:00+02:00">
                Updated: Wed 28 January 2015
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/alexander-velytchko.html">Alexander Velytchko</a>
        </address>
<p>In <a href="/category/ruby.html">Ruby</a>. </p>
<p>tags: <a href="/tag/ruhoh.html">ruhoh</a> <a href="/tag/publishing.html">publishing</a> </p>
</footer><!-- /.post-info --><p>Ruhoh - это статический генератор сайтов, написанный на Ruby.</p>
<h4>Установка</h4>
<p>Для Ruhoh нужен ruby и git. В Debian/Ubuntu устанавливается с помощью apt-get, в среде Windows нужно скачать инсталляторы Ruby и DevKit с <a href="http://rubyinstaller.org/downloads/">rubyinstaller.org</a> и git с <a href="http://git-scm.com/downloads">git-scm.com</a>.</p>
<div class="highlight"><pre><span class="nv">$ </span>sudo apt-get install ruby ruby-dev git gcc libxml2-dev libxslt1-dev zlib1g-dev
</pre></div>


<p>Установка Ruhoh хорошо описана на <a href="http://ruhoh.com/docs/2/installation/">официальном сайте</a> и состоит из следующих пунктов:</p>
<div class="highlight"><pre><span class="nv">$ </span>sudo gem install bundler
<span class="nv">$ </span>mkdir ruhoh-site
<span class="nv">$ </span><span class="nb">cd </span>ruhoh-site
<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">&quot;source \&quot;https://rubygems.org\&quot;&quot;</span> &gt;&gt; Gemfile
<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">&quot;gem &#39;ruhoh&#39;, \&quot;~&gt; 2\&quot;&quot;</span> &gt;&gt; Gemfile
<span class="nv">$ </span>bundle install
</pre></div>


<p>Если все зависимости и установка прошла без ошибок, можно запустить встроенный в Ruhoh веб-сервер и посмотреть что получилось, открыв в браузере <a href="http://localhost:9292">http://localhost:9292</a></p>
<div class="highlight"><pre><span class="nv">$ </span>bundle <span class="nb">exec </span>ruhoh server 9292
</pre></div>


<p>Пока это каркас, хотя уже и вполне рабочий, но для полноценного блога/сайта лучше установить тему, предварительно настроив git (добавить <code>~/.ssh/id_rsa.pub</code> в Github аккаунт):</p>
<div class="highlight"><pre><span class="nv">$ </span>ssh-keygen
<span class="nv">$ </span><span class="nb">eval</span> <span class="sb">`</span>ssh-agent<span class="sb">`</span>
<span class="nv">$ </span>ssh-add
<span class="nv">$ </span>git clone git@github.com:ruhoh/theme-bootstrap-2.git theme-bootstrap-2
<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">&quot;\&quot;theme-bootstrap-2\&quot; :&quot;</span> &gt; config.yml
<span class="nv">$ </span><span class="nb">echo</span> <span class="s2">&quot;  \&quot;use\&quot; : \&quot;theme\&quot;&quot;</span> &gt;&gt; config.yml
</pre></div>


<p>Изменить значения по умолчанию можно с помощью файла <code>data.yml</code> в директории <code>theme-bootstrap-2</code>:</p>
<div class="highlight"><pre><span class="l-Scalar-Plain">title</span> <span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Site Title</span>
<span class="l-Scalar-Plain">tagline</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">Site Tagline</span>
<span class="l-Scalar-Plain">author</span> <span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">name</span> <span class="p-Indicator">:</span> <span class="l-Scalar-Plain">First-name Last-name</span>
  <span class="l-Scalar-Plain">email</span> <span class="p-Indicator">:</span> <span class="l-Scalar-Plain">blah@email.test</span>
  <span class="l-Scalar-Plain">github</span> <span class="p-Indicator">:</span> <span class="l-Scalar-Plain">username</span>
  <span class="l-Scalar-Plain">twitter</span> <span class="p-Indicator">:</span> <span class="l-Scalar-Plain">username</span>
  <span class="l-Scalar-Plain">feedburner</span> <span class="p-Indicator">:</span> <span class="l-Scalar-Plain">feedname</span>

<span class="l-Scalar-Plain">navigation</span> <span class="p-Indicator">:</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">archive</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">tags</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">categories</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">pages</span>
  <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">about</span>
</pre></div>


<p>Создание новых страниц происходит автоматически при открытии несуществующего url в браузере, например <a href="http://localhost:9292/posts/new-post">http://localhost:9292/posts/new-post</a> или вручную, создавая соответствуюшие файлы в структуре каталога. Используется разметка <a href="http://daringfireball.net/projects/markdown">markdown</a> (<a href="http://markable.in/file/aa191728-9dc7-11e1-91c7-984be164924a/">шпаргалка</a>). Детальнее про создание страниц, включая использование коммандной строки, в <a href="http://ruhoh.com/docs/2/pages/">официальной документации</a>.</p>
<hr />
<h4>Публикация</h4>
<p>Ruhoh может публиковать сайт с помощью rsync на удаленный сервер и на Github благодаря плагину github.rb. Для настройки rsync нужно создать файл <code>publish.json</code>:</p>
<div class="highlight"><pre><span class="p">{</span>
    <span class="nt">&quot;rsync&quot;</span> <span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;user&quot;</span> <span class="p">:</span> <span class="s2">&quot;rand&quot;</span><span class="p">,</span>
        <span class="nt">&quot;host&quot;</span> <span class="p">:</span> <span class="s2">&quot;198.35.45.210&quot;</span><span class="p">,</span>
        <span class="nt">&quot;destination&quot;</span> <span class="p">:</span> <span class="s2">&quot;/var/www/rand.kiev.ua/cate&quot;</span><span class="p">,</span>
        <span class="nt">&quot;command&quot;</span> <span class="p">:</span> <span class="s2">&quot;rsync compiled/. -avz --delete --chmod=Du=rwx,Dg=rx,Do=rx,Fu=rw,Fg=r,Fo=r --exclude .git rand@198.35.45.210:/var/www/rand.kiev.ua/cate&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>Аттрибут <code>"command"</code> опциональный, в примере выше он необходим для корректного выставления прав на директории и файлы из среды Windows. Чтобы после публикации ссылки были корректные, нужно отредактировать <code>config.yml</code>, если сайт будет располагаться не в корне.</p>
<div class="highlight"><pre># config.yml
base_path: &quot;/blog&quot;
production_url : &#39;http://cate.rand.kiev.ua/blog&#39;
</pre></div>


<p>Поддержка Github'а все еще экспериментальная. Плагин (актульно для версии Ruhoh 2.6) <a href="https://gist.github.com/jaimalchohan/8090954">github.rb</a> нужно сохранить в директорию <code>plugins/publish</code>. Далее будет описываться процесс для публикации сайта в корень username.github.io. Директорию ruhoh-site необходимо переименовать в username.github.com и инициализировать внутри репозиторий с бранчем <code>gh-pages</code>. Почему именно так - объясняется на <a href="https://help.github.com/articles/creating-project-pages-manually">Github</a>.</p>
<div class="highlight"><pre><span class="nv">$ </span><span class="nb">cd </span>avelytchko.github.io
<span class="nv">$ </span>rm -rf theme-bootstrap-2/.git/
<span class="nv">$ </span>git init
<span class="nv">$ </span>git add .
<span class="nv">$ </span>git checkout --orphan gh-pages
<span class="nv">$ </span>git commit -m <span class="s2">&quot;first commit&quot;</span>
<span class="nv">$ </span>git remote add origin git@github.com:avelytchko/avelytchko.github.io.git
<span class="nv">$ </span>bundle <span class="nb">exec </span>ruhoh publish github
</pre></div>


<p>Если все сделано верно, через несколько минут на Github'е появится статичный сайт, скомпилированный ruhoh. Для изменения старых или добавления новых страниц, нужно воспользоваться коммандой ниже, не забывая при этом, что бранч по умолчанию - <code>gh-pages</code>.</p>
<div class="highlight"><pre><span class="nv">$ </span>git add .
<span class="nv">$ </span>git commit -m <span class="s2">&quot;minor changes&quot;</span>
<span class="nv">$ </span>bundle <span class="nb">exec </span>ruhoh publish github
</pre></div><p>There are <a href="/ruhoh-install.html#disqus_thread">comments</a>.</p>                </article>
<p class="paginator">
    Page 1 / 1
</p>
            </aside><!-- /#featured -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

<script type="text/javascript">
    var disqus_shortname = 'avelytchko';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>